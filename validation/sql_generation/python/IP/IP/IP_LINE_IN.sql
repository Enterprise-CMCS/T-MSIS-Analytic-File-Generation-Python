create
or replace temporary view IP_LINE_IN as
select
    SUBMTG_STATE_CD,
    upper(a.TMSIS_FIL_NAME) as tmsis_fil_name,
    a.REC_NUM,
    a.TMSIS_RUN_ID,
    a.TMSIS_ACTV_IND,
    coalesce(a.ADJDCTN_DT, to_date('01JAN1960')) as ADJDCTN_DT,
    a.SRVC_BGNNG_DT,
    upper(a.BNFT_TYPE_CD) as bnft_type_cd,
    upper(a.CLL_STUS_CD) as cll_stus_cd,
    upper(a.CMS_64_FED_REIMBRSMT_CTGRY_CD) as cms_64_fed_reimbrsmt_ctgry_cd,
    a.SRVC_ENDG_DT,
    upper(a.HCPCS_RATE) as hcpcs_rate,
    coalesce(upper(a.ADJSTMT_CLM_NUM), '~') as ADJSTMT_CLM_NUM,
    coalesce(upper(a.ORGNL_CLM_NUM), '~') as ORGNL_CLM_NUM,
    upper(a.IMNZTN_TYPE_CD) as imnztn_type_cd,
    a.IP_LT_ACTL_SRVC_QTY,
    a.IP_LT_ALOWD_SRVC_QTY,
    a.LINE_ADJSTMT_IND,
    upper(a.ADJSTMT_LINE_NUM) as adjstmt_line_num,
    upper(a.ORGNL_LINE_NUM) as orgnl_line_num,
    a.ALOWD_AMT,
    a.MDCD_FFS_EQUIV_AMT,
    upper(a.MSIS_IDENT_NUM) as msis_ident_num,
    upper(a.NDC_CD) as ndc_cd,
    a.NDC_QTY,
    a.NDC_UOM_CD,
    upper(a.OPRTG_PRVDR_NPI_NUM) as oprtg_prvdr_npi_num,
    upper(a.PRVDR_FAC_TYPE_CD) as prvdr_fac_type_cd,
    a.REV_CHRG_AMT,
    upper(a.REV_CD) as rev_cd,
    upper(a.PRSCRBNG_PRVDR_NPI_NUM) as prscrbng_prvdr_npi_num,
    upper(a.SRVCNG_PRVDR_NUM) as srvcng_prvdr_num,
    upper(a.SRVCNG_PRVDR_SPCLTY_CD) as srvcng_prvdr_spclty_cd,
    upper(a.SRVCNG_PRVDR_TXNMY_CD) as srvcng_prvdr_txnmy_cd,
    upper(a.SRVCNG_PRVDR_TYPE_CD) as srvcng_prvdr_type_cd,
    a.SUBMTG_STATE_CD,
    a.STC_CD,
    upper(a.XIX_SRVC_CTGRY_CD) as xix_srvc_ctgry_cd,
    upper(a.XXI_SRVC_CTGRY_CD) as xxi_srvc_ctgry_cd,
    a.MDCD_PD_AMT,
    a.OTHR_INSRNC_AMT
from
    cms_prod.TMSIS_CLL_REC_IP A
where
    a.TMSIS_ACTV_IND = 1
    and (a.submtg_state_cd, a.tmsis_run_id) in (
        concat('01', 4574),
        concat('02', 4567),
        concat('04', 4554),
        concat('05', 4550),
        concat('06', 4556),
        concat('08', 4578),
        concat('09', 4568),
        concat('10', 4557),
        concat('11', 4545),
        concat('12', 4555),
        concat('13', 4538),
        concat('15', 4558),
        concat('16', 4579),
        concat('17', 4584),
        concat('18', 4561),
        concat('19', 4548),
        concat('20', 4589),
        concat('21', 4553),
        concat('22', 4573),
        concat('23', 4540),
        concat('24', 4569),
        concat('25', 4559),
        concat('26', 4585),
        concat('27', 4539),
        concat('28', 4594),
        concat('29', 4562),
        concat('30', 4580),
        concat('31', 4546),
        concat('32', 4551),
        concat('33', 4570),
        concat('34', 4590),
        concat('35', 4552),
        concat('36', 4566),
        concat('37', 4517),
        concat('38', 4575),
        concat('39', 4571),
        concat('40', 4593),
        concat('41', 4541),
        concat('42', 4560),
        concat('44', 4592),
        concat('45', 4544),
        concat('46', 4549),
        concat('47', 4583),
        concat('48', 4507),
        concat('49', 4577),
        concat('50', 4581),
        concat('51', 4564),
        concat('53', 4587),
        concat('54', 4582),
        concat('55', 4565),
        concat('56', 4423),
        concat('72', 4547),
        concat('78', 4563),
        concat('93', 4447),
        concat('97', 4543)
    )

create temp table IP_LINE_IN distkey (ORGNL_CLM_NUM_LINE) sortkey (
    SUBMTG_STATE_CD,
    ORGNL_CLM_NUM_LINE,
    ADJSTMT_CLM_NUM_LINE,
    ADJDCTN_DT_LINE,
    LINE_ADJSTMT_IND
) as
select
    SUBMTG_STATE_CD,
    upper(a.TMSIS_FIL_NAME) as tmsis_fil_name,
    a.REC_NUM,
    a.TMSIS_RUN_ID as TMSIS_RUN_ID_LINE,
    a.TMSIS_ACTV_IND as TMSIS_ACTV_IND_LINE,
    coalesce(a.ADJDCTN_DT, '01JAN1960') as ADJDCTN_DT_LINE,
    coalesce(a.SRVC_BGNNG_DT, '01JAN1960') as SRVC_BGNNG_DT,
    upper(a.BNFT_TYPE_CD) as bnft_type_cd,
    upper(a.CLL_STUS_CD) as cll_stus_cd,
    upper(a.CMS_64_FED_REIMBRSMT_CTGRY_CD) as cms_64_fed_reimbrsmt_ctgry_cd,
    coalesce(a.SRVC_ENDG_DT, '01JAN1960') as SRVC_ENDG_DT,
    upper(a.HCPCS_RATE) as hcpcs_rate,
    coalesce(upper(a.ADJSTMT_CLM_NUM), '~') as ADJSTMT_CLM_NUM_LINE,
    coalesce(upper(a.ORGNL_CLM_NUM), '~') as ORGNL_CLM_NUM_LINE,
    upper(a.IMNZTN_TYPE_CD) as imnztn_type_cd,
    a.IP_LT_ACTL_SRVC_QTY,
    a.IP_LT_ALOWD_SRVC_QTY,
    coalesce(upper(a.LINE_ADJSTMT_IND), 'X') as LINE_ADJSTMT_IND,
    upper(a.ADJSTMT_LINE_NUM) as adjstmt_line_num,
    upper(a.ORGNL_LINE_NUM) as orgnl_line_num,
    a.ALOWD_AMT,
    a.MDCD_FFS_EQUIV_AMT,
    upper(a.MSIS_IDENT_NUM) as MSIS_IDENT_NUM_LINE,
    upper(a.NDC_CD) as ndc_cd,
    a.NDC_QTY,
    upper(a.NDC_UOM_CD) as uom_cd,
    upper(a.OPRTG_PRVDR_NPI_NUM) as oprtg_prvdr_npi_num,
    upper(a.PRVDR_FAC_TYPE_CD) as prvdr_fac_type_cd,
    a.REV_CHRG_AMT,
    upper(a.REV_CD) as rev_cd,
    upper(a.PRSCRBNG_PRVDR_NPI_NUM) as prscrbng_prvdr_npi_num,
    upper(a.SRVCNG_PRVDR_NUM) as srvcng_prvdr_num,
    upper(a.SRVCNG_PRVDR_SPCLTY_CD) as srvcng_prvdr_spclty_cd,
    upper(a.SRVCNG_PRVDR_TXNMY_CD) as srvcng_prvdr_txnmy_cd,
    upper(a.SRVCNG_PRVDR_TYPE_CD) as srvcng_prvdr_type_cd,
    upper(a.SUBMTG_STATE_CD) as SUBMTG_STATE_CD_LINE,
    upper(a.STC_CD) as tos_cd,
    upper(lpad(trim(a.XIX_SRVC_CTGRY_CD), 4, '0')) as XIX_SRVC_CTGRY_CD,
    upper(lpad(trim(a.XXI_SRVC_CTGRY_CD), 3, '0')) as XXI_SRVC_CTGRY_CD,
    a.MDCD_PD_AMT,
    a.OTHR_INSRNC_AMT
from
    cms_prod.TMSIS_CLL_REC_IP A
where
    a.TMSIS_ACTV_IND = 1
    and (a.submtg_state_cd, a.tmsis_run_id) in (
        ('01', 4516),
        ('02', 4530),
        ('04', 4491),
        ('05', 4492),
        ('06', 4518),
        ('08', 4500),
        ('09', 4485),
        ('10', 4493),
        ('11', 4490),
        ('12', 4502),
        ('13', 4494),
        ('15', 4503),
        ('16', 4519),
        ('17', 4520),
        ('18', 4497),
        ('19', 4511),
        ('20', 4482),
        ('21', 4486),
        ('22', 4496),
        ('23', 4499),
        ('24', 4531),
        ('25', 4504),
        ('26', 4528),
        ('27', 4481),
        ('28', 4479),
        ('29', 4524),
        ('30', 4529),
        ('31', 4505),
        ('32', 4512),
        ('33', 4532),
        ('34', 4477),
        ('35', 4483),
        ('36', 4527),
        ('37', 4517),
        ('38', 4510),
        ('39', 4506),
        ('40', 4480),
        ('41', 4513),
        ('42', 4495),
        ('44', 4534),
        ('45', 4488),
        ('46', 4521),
        ('47', 4525),
        ('48', 4507),
        ('49', 4484),
        ('50', 4522),
        ('51', 4508),
        ('53', 4526),
        ('54', 4515),
        ('55', 4514),
        ('56', 4423),
        ('72', 4501),
        ('78', 4523),
        ('93', 4447),
        ('97', 4487)
    )